
@if (user) {

  <div class="user-menu-card">

    <div>
      <img
        height="200"
        *ngIf="user.userProfileImage"
        [src]="user.userProfileImage"
        >

      @if (change_display_name_form_toggle) {

        <input
          class="form-control"
          [formControl]="this.displayNameForm"
          type="text"
          required="false"
          [placeholder]="user.displayName"
          >

        <app-static-errors [WARNINGS]="[{
            show:displayNameForm.hasError('pattern') ,
            message:displayNameFormWarnings.pattern
          },{
            show:displayNameForm.value && displayNameForm.value.length < preferences.DISPLAY_NAME_MIN,
            message:displayNameFormWarnings.min
          },{
            show:displayNameForm.value.length > preferences.DISPLAY_NAME_MAX,
            message:displayNameFormWarnings.max
          },]"></app-static-errors>

        <button
          class="btn btn-secondary"
          (click)="toggleChangeDisplayNameForm()"
        >
          Cancel
        </button>
        <button
          class="btn btn-primary"
          (click)="changeDisplayName()"
          [disabled]="this.displayNameForm.invalid"
        >
          Change!
        </button>

        <app-server-errors [serverErrorHandler]="this.serverErrorHandler"></app-server-errors>
      } @else {
        <h1>{{ user.displayName + " " }}<i class="bi bi-pencil" (click)="toggleChangeDisplayNameForm()"></i></h1>
      }

      <h3>{{ user.email }}</h3>

    </div>

    <app-image-upload-and-crop
      userDialog="Update profile image"
      [MAINTAIN_ASPECT_RATIO]="true"
      [ASPECT_RATIO]="1"
      (imageCroppedAndReadyEvent)="updateUserProfileImage($event)"
      *ngIf="!PROCESSING_REQUEST"
      ></app-image-upload-and-crop>

    <br>

    <div class="form-check form-switch" style="margin: 0; padding: 0; display: flex; flex-direction: row">
      <label class="form-check-label" for="flexSwitchCheckDefault">Dark Mode?</label>

      <input
        style="scale: 2; margin-left: 30px"
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="flexSwitchCheckDefault"
        (change)="darkModeUpdated($event)"
        [checked]="dark_mode_switch_toggle"
        >
    </div>
  </div>

}